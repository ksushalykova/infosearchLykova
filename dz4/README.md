Домашнее задание №4

Так как файл с bert матрицей слишком большой, сюда он не грузится. Ссылка: https://drive.google.com/file/d/1-8xUU1lhJprOYMepJda9C549lt4m6rhe/view?usp=sharing

Для запуска функция main.py запускается после введения в командную строку пути с питоновским файлом main.py и всех аргументов, упомянутых в add_argument (то есть, пути до файла с корпусом ответов, пути до сохраненной bert матрицы, полученной в гугл коллабе с помощью ускоряющей среды GPU, и запроса). 

Код разбит на модули. В модуле загрузки данных выполняется получение ответов пользователей с самым высоким рейтингом в датасете ответы мэйл.ру. Затем в модуле препроцессинга происходит предобработка этих ответов - получение предобработанного корпуса. После этого грузятся модель и токенайзер, и происходит предобработка и индексация запроса, так же, как и корпуса. Потом считается косинусная близость между запросом и всеми документами корпуса, далее документы сортируются в порядке убывания косинусной близости, потом выдаются наиболее близкие к запросу документы. 
